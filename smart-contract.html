

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Smart Contract &mdash; Enigma Data Marketplace 0.4 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Enigma Data Marketplace 0.4 documentation" href="index.html"/>
        <link rel="next" title="User Guide" href="user-guide.html"/>
        <link rel="prev" title="Introduction" href="introduction.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        
          <a href="index.html" class="icon icon-home"> Enigma Data Marketplace
        

        
        </a>

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="introduction.html#registration">Registration</a></li>
<li class="toctree-l2"><a class="reference internal" href="introduction.html#subscription">Subscription</a></li>
<li class="toctree-l2"><a class="reference internal" href="introduction.html#consumption">Consumption</a></li>
<li class="toctree-l2"><a class="reference internal" href="introduction.html#incentives">Incentives</a></li>
<li class="toctree-l2"><a class="reference internal" href="introduction.html#data-privacy">Data privacy</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Smart Contract</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#registration">Registration</a></li>
<li class="toctree-l2"><a class="reference internal" href="#subscription">Subscription</a></li>
<li class="toctree-l2"><a class="reference internal" href="#the-marketplace-contract-functionality">The MarketPlace contract functionality</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#subscribe-bytes32-sourcename">subscribe(bytes32 sourceName)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#register-bytes32-sourcename-uint-price-address-owner">register(bytes32 sourceName, uint price, address owner)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#checkaddresssubscription-address-subscriber-bytes32-dataname">checkAddressSubscription(address subscriber, bytes32 dataName)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#source-code">Source code</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="user-guide.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="authentication.html">Authentication</a></li>
<li class="toctree-l1"><a class="reference internal" href="data-sets.html">Data Sets</a></li>
<li class="toctree-l1"><a class="reference internal" href="data-providers.html">Data Providers</a></li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Enigma Data Marketplace</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Smart Contract</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/smart-contract.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="smart-contract">
<h1>Smart Contract<a class="headerlink" href="#smart-contract" title="Permalink to this headline">¶</a></h1>
<p>The Enigma Data Marketplace is governed by a smart contract deployed on the
Ethereum network that is operated directly with Enigma tokens (ENG). The smart
contract allows data curators to register new data sets, and allows users to
subscribe to existing data sets. The subscription period defaults to
<em>one month</em>, and prices for all data sets are designated accordigly as monthly
costs.</p>
<p>The Enigma Data Marketplace contract is publicly available and can be used by
any other contract in the network. The smart contract stores each of the data
sets metadata (owner, price, number of subscriptions,...) and information about
each subscription to any data set (price, start time and end time).</p>
<div class="section" id="registration">
<h2>Registration<a class="headerlink" href="#registration" title="Permalink to this headline">¶</a></h2>
<p>In order to make a new data set available in the marketplace, the data curator
needs to register with the smart contract by sending a register transaction with
the following details:</p>
<ul>
<li><p class="first"><strong>Datasource name</strong></p>
<blockquote>
<div><p>Data source names are strings that must be unique. The name can be any
string as long as it doesn&#8217;t exist in the contract registry already and
its length is less than 32 bytes.</p>
</div></blockquote>
</li>
<li><p class="first"><strong>Datasource price</strong></p>
<blockquote>
<div><p>The price is designated in ENG Tokens for a monthly subscription.</p>
</div></blockquote>
</li>
<li><p class="first"><strong>Datasource owner:</strong></p>
<blockquote>
<div><p>The address of the owner of the data source. This address is where the
payments from the users&#8217; subscriptions to this data source will be sent to.
The owner&#8217;s address also allows for changing the price (does not effect
active subscriptions, only new subscriptions and renewals), and deactivating
a data set.</p>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="subscription">
<h2>Subscription<a class="headerlink" href="#subscription" title="Permalink to this headline">¶</a></h2>
<p>In order to access an existing data set, a user needs to subscribe to the
desired data set through a two-step process:</p>
<ol class="arabic simple">
<li>The subscriber approves the Enigma Data Marketplace contract as a
spender in the Enigma ERC20 contract on their behalf for the
specified amount for that data set.</li>
</ol>
<ol class="arabic simple" start="3">
<li>Once the Marketplace contract has been approved, a user can send a
subscription transaction that includes the desired data source name. The
price is specified in the data set (stored in the marketplace contract), and
the amount is transferred on behalf of the user (after the pre-approval
from step #1 above succeeds).</li>
</ol>
<img alt="Enigma Data Marketplace subscription" class="align-center" src="http://ethereumisrael.org/wp-content/uploads/2018/01/SubscriptionProtocolDiagram.png" />
</div>
<div class="section" id="the-marketplace-contract-functionality">
<h2>The MarketPlace contract functionality<a class="headerlink" href="#the-marketplace-contract-functionality" title="Permalink to this headline">¶</a></h2>
<p>Enigma&#8217;s Data Marketplace provides the following functionality.</p>
<div class="section" id="subscribe-bytes32-sourcename">
<h3>subscribe(bytes32 sourceName)<a class="headerlink" href="#subscribe-bytes32-sourcename" title="Permalink to this headline">¶</a></h3>
<p>Subscribes to a data source after approving the marketplace contract in
the ENG token contract as a spender on behalf of the subscriber. The amount
of ENG available on the subscriber&#8217;s address should be equal or larger than the
price of the desired data set.</p>
</div>
<div class="section" id="register-bytes32-sourcename-uint-price-address-owner">
<h3>register(bytes32 sourceName, uint price, address owner)<a class="headerlink" href="#register-bytes32-sourcename-uint-price-address-owner" title="Permalink to this headline">¶</a></h3>
<p>Registers a new data source. <code class="docutils literal"><span class="pre">sourceName</span></code> must be unique, and <code class="docutils literal"><span class="pre">price</span></code> is
designated in ENG Tokens for a monthly subscription.</p>
</div>
<div class="section" id="checkaddresssubscription-address-subscriber-bytes32-dataname">
<h3>checkAddressSubscription(address subscriber, bytes32 dataName)<a class="headerlink" href="#checkaddresssubscription-address-subscriber-bytes32-dataname" title="Permalink to this headline">¶</a></h3>
<p>Given a subscriber address and an existing data set, returns the following
details of the user&#8217;s subscription to that data set</p>
<ul class="simple">
<li>address subscriber</li>
<li>uint price</li>
<li>uint startTime</li>
<li>uint endTime</li>
<li>bool expired</li>
</ul>
<img alt="Enigma Data Marketplace contract UML" class="align-center" src="http://ethereumisrael.org/wp-content/uploads/2018/01/MarketPlaceContractUML-1.png" />
</div>
</div>
<div class="section" id="source-code">
<h2>Source code<a class="headerlink" href="#source-code" title="Permalink to this headline">¶</a></h2>
<p>The soure code for the smart contract is available at:
<a class="reference external" href="https://github.com/enigmampc/smart_contract_marketplace/blob/master/contracts/Marketplace.sol">https://github.com/enigmampc/smart_contract_marketplace/blob/master/contracts/Marketplace.sol</a></p>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="user-guide.html" class="btn btn-neutral float-right" title="User Guide" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="introduction.html" class="btn btn-neutral" title="Introduction" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Enigma MPC, Inc..
    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.4',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>