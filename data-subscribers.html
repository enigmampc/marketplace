
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Data Subscribers &#8212; Enigma Data Marketplace 0.4 documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/css/theme_overrides.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Data Providers" href="data-providers.html" />
    <link rel="prev" title="Configuration" href="configuration.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="data-providers.html" title="Data Providers"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="configuration.html" title="Configuration"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Enigma Data Marketplace 0.4 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="data-subscribers">
<h1>Data Subscribers<a class="headerlink" href="#data-subscribers" title="Permalink to this headline">¶</a></h1>
<p>Catalyst users may subscribe to data sets from the Enigma Data Marketplace
and use them in their trading algorithms. Depending on their properties,
data sets may be usable for backtesting as well as live trading.</p>
<div class="section" id="subscribe">
<h2>Subscribe<a class="headerlink" href="#subscribe" title="Permalink to this headline">¶</a></h2>
<p>The Enigma Data Marketplace enables data providers to publish data sets and make
them directly available to subscribers. All published data is validated and
hosted on the Enigma Data Marketplace. Your subscription payment is protected
by the <a class="reference internal" href="smart-contract.html"><span class="doc">Enigma Data Marketplace Smart Contract</span></a>. If a
provider stops delivering data as per their agreement, the subscriber will be
automatically refunded on a <em>pro rata</em> basis for the unfulfilled portion of
their subscription.</p>
<p>The following command subscribes to the <code class="docutils literal notranslate"><span class="pre">marketcap</span></code> data set:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ catalyst marketplace subscribe --dataset<span class="o">=</span>marketcap

The price <span class="k">for</span> a monthly subscription to this dataset is <span class="m">10</span> ENG
Checking that the ENG balance in 0x..... is greater than <span class="m">10</span> ENG... OK.
Please confirm that you agree to pay <span class="m">10</span> ENG <span class="k">for</span> a monthly subscription to the dataset <span class="s2">&quot;marketcap&quot;</span> starting today. <span class="o">[</span>default: Y<span class="o">]</span>
Ready to subscribe to dataset marketcap.
</pre></div>
</div>
<p>Catalyst will then provide you with instructions to sign two different
transactions to process your subscription to the dataset.</p>
</div>
<div class="section" id="ingest">
<h2>Ingest<a class="headerlink" href="#ingest" title="Permalink to this headline">¶</a></h2>
<p>The Catalyst <code class="docutils literal notranslate"><span class="pre">ingest-data</span></code> command downloads and makes the given data set
available locally for backtesting or live trading with Catalyst.</p>
<p>The following command ingests the <code class="docutils literal notranslate"><span class="pre">marketcap</span></code> data set:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ catalyst marketplace ingest --dataset<span class="o">=</span>marketcap
Starting download of dataset <span class="k">for</span> ingestion...
Dataset downloaded successfully. Processing dataset...
INFO: Marketplace: Processing file <span class="m">0</span> of <span class="m">1</span>
INFO: Marketplace: Processing file <span class="m">1</span> of <span class="m">1</span>
</pre></div>
</div>
<p>If you need to keep the data up to date while running a live algorithm, you can
schedule a job (<code class="docutils literal notranslate"><span class="pre">cron</span></code> in Linux/MacOS) to run the above command at periodic
intervals, and the live/paper trading algorithm will always retrieve the latest
data available on disk on every iteration of the algorithm.</p>
</div>
<div class="section" id="use-in-an-algorithm">
<h2>Use in an Algorithm<a class="headerlink" href="#use-in-an-algorithm" title="Permalink to this headline">¶</a></h2>
<p>Once you have subscribed to a data set, and ingested the required data if
appropriate, the data source is now usable in your algorithms.</p>
<p>This snippet of code below shows how to use our Marketcap data set in the
<cite>initialize()</cite> function of an algorithm to rank the top-five asset by
market cap:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">catalyst.api</span> <span class="kn">import</span> <span class="n">get_dataset</span>
<span class="kn">from</span> <span class="nn">catalyst.exchange.utils.stats_utils</span> <span class="kn">import</span> <span class="n">set_print_settings</span>

<span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">context</span><span class="p">):</span>
    <span class="c1"># Get the marketcap data</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">get_dataset</span><span class="p">(</span>
        <span class="s1">&#39;marketcap&#39;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">context</span><span class="o">.</span><span class="n">datetime</span>
    <span class="p">)</span>  <span class="c1"># type: pd.DataFrame</span>

    <span class="c1"># Keep only the 100 top currencies by market cap</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;market_cap_usd&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;market_cap_usd&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nlargest</span><span class="p">(</span><span class="mi">100</span><span class="p">))]</span>
    <span class="c1"># Sort the currencies by market cap</span>
    <span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;market_cap_usd&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

    <span class="c1"># Prepare the standard output for a wide DataFrame</span>
    <span class="n">set_print_settings</span><span class="p">()</span>
    <span class="c1"># Display the top 100 largest currencies</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;the marketplace data:</span><span class="se">\n</span><span class="s1">{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>

    <span class="c1"># Out of the 100 largest currencies, we want to trade the smallest</span>
    <span class="c1"># 5 markets with an Ether quote on the exchange of our algorithm</span>
    <span class="n">quote_currency</span> <span class="o">=</span> <span class="s1">&#39;eth&#39;</span>
    <span class="n">exchange</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">exchanges</span><span class="p">[</span><span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">exchanges</span><span class="p">))]</span>
    <span class="c1"># Get a list of symbols only for assets tradable since the start</span>
    <span class="c1"># date of our algorithm.</span>
    <span class="n">symbols</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">symbol</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">exchange</span><span class="o">.</span><span class="n">assets</span>
               <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">start_date</span> <span class="o">&lt;</span> <span class="n">context</span><span class="o">.</span><span class="n">datetime</span><span class="p">]</span>

    <span class="c1"># Initialize an asset list which we will populate with the 5 smallest</span>
    <span class="c1"># markets</span>
    <span class="n">context</span><span class="o">.</span><span class="n">assets</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">currency</span><span class="p">,</span> <span class="n">price</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;market_cap_usd&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">assets</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">:</span>
            <span class="k">break</span>

        <span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;{}_{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">currency</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">),</span> <span class="n">quote_currency</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">symbols</span><span class="p">:</span>
            <span class="n">context</span><span class="o">.</span><span class="n">assets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">symbol</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Data Subscribers</a><ul>
<li><a class="reference internal" href="#subscribe">Subscribe</a></li>
<li><a class="reference internal" href="#ingest">Ingest</a></li>
<li><a class="reference internal" href="#use-in-an-algorithm">Use in an Algorithm</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="configuration.html"
                        title="previous chapter">Configuration</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="data-providers.html"
                        title="next chapter">Data Providers</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/data-subscribers.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="data-providers.html" title="Data Providers"
             >next</a> |</li>
        <li class="right" >
          <a href="configuration.html" title="Configuration"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Enigma Data Marketplace 0.4 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, Enigma MPC, Inc..
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.5.
    </div>
  </body>
</html>